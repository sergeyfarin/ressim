# TODO 2026

## Completed in this review
- Removed stray code fences from `src/lib/FractionalFlow.svelte` so it compiles as a component.
- Cleaned up unused Rust import warning in `src/lib/ressim/src/lib.rs` (`rand::Rng`).
- Verified P4-1 benchmark tests against analytical Buckley-Leverett references (both cases passing tolerance).
- Added benchmark results summary section to the bottom of the frontend page in `src/App.svelte`.
- Implemented P4-5 benchmark artifact pipeline: `scripts/export-benchmarks.mjs` now generates `public/benchmark-results.json` from Rust test output.
- Frontend benchmark summary now loads from generated artifact first, with fallback defaults if artifact is unavailable.
- Added lightweight GitHub Actions workflow to publish `public/benchmark-results.json` as an artifact on every push/PR.
- Tightened frontend analytical Buckley-Leverett calculation in `src/lib/FractionalFlow.svelte` to better match benchmark reference logic.
- Added refined discretization benchmark test proving lower analytical mismatch with finer grid/timestep.
- Added frontend benchmark Baseline/Refined mode toggle to make discretization-impact evidence directly visible to users.
- Aligned frontend analytical curve evaluation times with simulation `rateHistory` times for like-for-like plot comparison.

## 3D Browser Simulator Review Snapshot (2026-02-15)
- Frontend build (`npm run build`) passes.
- Rust core build (`cargo check`) passes.
- Known non-blocking warnings: DaisyUI CSS at-rule compatibility and large JS chunk warning.

## P0 Must-Have Implementation
- [x] P0-1 Stability: Harden well creation path in `src/lib/ressim/src/lib.rs` by validating indices and PI preconditions before cell indexing.
- [x] P0-2 Correctness: Align frontend pressure unit label with simulator units (bar) in `src/App.svelte`.
- [x] P0-3 Correctness: Add bounds/physical validation for SCAL and permeability setter inputs in Rust (`setRelPermProps`, random/per-layer permeability).

## P1 Must-Have Follow-Ups
- [x] P1-1 Performance: Cap or decimate history snapshots and reduce repeated deep clone paths in `src/App.svelte`.
- [x] P1-2 Visualization: Reduce 3D render overhead (wireframe strategy) and throttle tooltip raycasting in `src/lib/3dview.svelte`.
- [x] P1-3 Reliability: Ensure all renderer event listeners are cleaned up on destroy.
- [x] P1-4 Quality Gate: Add Rust regression tests for saturation bounds, mass-balance sanity checks, and timestep adaptation behavior.

## Pending / Core feature follow-ups

### P3 (Next practical implementation wave)
- [x] `P3-1` Baseline profiling pass (Rust step loop + Svelte/Three render timings) and capture target budgets.
- [x] `P3-2` Move simulation stepping into a Web Worker with message-based state updates to keep UI responsive.
- [x] `P3-3` Split heavy visualization/chart code paths (lazy-load chart/3D modules) to reduce initial bundle pressure.
- [x] `P3-4` Add deterministic scenario presets + reproducible permeability seed controls for consistent demos.

### P4 (Model credibility and validation expansion)
- [x] `P4-1` Benchmark simulator results against published two-phase reference cases and document acceptance tolerances in README.md and in a separate page accessible via link.
- [x] `P4-2` Re-enable analytical comparison flow and add explicit mismatch/error metrics in chart output.
- [x] `P4-3` Expand simulator regression suite (multi-well edge cases, stability stress cases, API input contract tests).
- [ ] `P4-4` Add adaptive visualization legend mode (fixed vs percentile) with clear unit labels and defaults.
- [x] `P4-5` Auto-generate benchmark result JSON from test/CI output and feed frontend summary from that artifact to avoid manual value drift.

### Nice-to-haves (Complex / longer-horizon)
- [x] `NTH-1` Implement gravity terms in pressure/flux equations (with toggle + validation cases).
- [ ] `NTH-2` Extend to 3-phase flow (oil/water/gas) 
- [ ] 'NTH-3' Optional aquifer coupling model.